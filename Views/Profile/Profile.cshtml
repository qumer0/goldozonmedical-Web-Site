@{
    ViewData["Title"] = "Profil Sayfası";
}

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="~/css/profile.css">
    <title>@ViewData["Title"]</title>
</head>
<body>
    <div class="profile-container">
        <h1>Profil Sayfanız</h1>

        <section class="profile-order-history">
            <h2>Geçmiş Siparişler</h2>
            <ul>
                <li>Sipariş #123 - 01/01/2024 - Toplam: 150 TL</li>
                <li>Sipariş #124 - 15/01/2024 - Toplam: 200 TL</li>
                <li>Sipariş #125 - 28/01/2024 - Toplam: 120 TL</li>
            </ul>
        </section>

        <section class="profile-address-section">
            <h2>Adres Ekleme</h2>
            <form id="addressForm">
                <div class="form-group">
                    <label for="addressTitle">Adres Başlığı:</label>
                    <input type="text" id="addressTitle" name="addressTitle" required />
                </div>
                <div class="form-group">
                    <label for="addressDetails">Adres Detayları:</label>
                    <textarea id="addressDetails" name="addressDetails" required></textarea>
                </div>
                <button type="submit">Adres Ekle</button>
            </form>
            <h3>Mevcut Adresler</h3>
            <ul id="addressList">
                <li>Ev - İstanbul, Türkiye</li>
                <li>İş - Ankara, Türkiye</li>
            </ul>
        </section>

        <section class="profile-user-info">
            <h2>Kullanıcı Bilgileri</h2>
            <p>Ad: John Doe</p>
            <p>Email: johndoe@example.com</p>
            <button id="editUserInfo">Bilgileri Düzenle</button>
        </section>
    </div>
    
    <script>
    document.getElementById("addressForm").onsubmit = function(event) {
        event.preventDefault(); // Formun varsayılan gönderimini engelle
        const addressTitle = document.getElementById("addressTitle").value;
        const addressDetails = document.getElementById("addressDetails").value;

        // Adresi sunucuya göndermek için bir AJAX isteği yapalım
        fetch('/Profile/AddAddress', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ title: addressTitle, details: addressDetails })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Başarılıysa adresi listeye ekleyelim
                const addressList = document.getElementById("addressList");
                const newAddress = document.createElement("li");
                newAddress.textContent = `${data.title} - ${data.details}`;
                addressList.appendChild(newAddress);

                // Formu sıfırla
                document.getElementById("addressForm").reset();
            } else {
                alert("Adres eklenirken bir hata oluştu.");
            }
        })
        .catch(error => {
            console.error("Hata:", error);
        });
    }
</script>

</body>
</html>
